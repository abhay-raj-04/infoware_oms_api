{
	"info": {
		"_postman_id": "74309009-e6f8-4648-834e-874a2de22b8c",
		"name": "OMS API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "38020145"
	},
	"item": [
		{
			"name": "Auth - Register",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"username\": \"buyer1\",\n  \"email\": \"buyer1@example.com\",\n  \"password\": \"pass123\",\n  \"role\": \"BUYER\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/auth/register",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"auth",
						"register"
					]
				}
			},
			"response": []
		},
		{
			"name": "Buyer - Login",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let json = {}; try { json = pm.response.json(); } catch(e) {}",
							"if (json.token) { pm.collectionVariables.set('buyerToken', json.token); }"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"buyer1@example.com\",\n  \"password\": \"pass123\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/auth/login",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"auth",
						"login"
					]
				}
			},
			"response": []
		},
		{
			"name": "Units - List",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let json = {}; try { json = pm.response.json(); } catch(e) {}",
							"if (json.data) {",
							"  const kg = json.data.find(u => u.symbol === 'KG'); if (kg) { pm.collectionVariables.set('KG_UOM_ID', kg.id); }",
							"  const gm = json.data.find(u => u.symbol === 'GM'); if (gm) { pm.collectionVariables.set('GM_UOM_ID', gm.id); }",
							"  const lt = json.data.find(u => u.symbol === 'LT'); if (lt) { pm.collectionVariables.set('LT_UOM_ID', lt.id); }",
							"  const ml = json.data.find(u => u.symbol === 'ML'); if (ml) { pm.collectionVariables.set('ML_UOM_ID', ml.id); }",
							"}"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/units",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"units"
					]
				}
			},
			"response": []
		},
		{
			"name": "Products - List",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/products",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"products"
					]
				}
			},
			"response": []
		},
		{
			"name": "Supplier - Register",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"username\": \"supp1\",\n  \"email\": \"supp1@example.com\",\n  \"password\": \"pass123\",\n  \"role\": \"SUPPLIER\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/auth/register",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"auth",
						"register"
					]
				}
			},
			"response": []
		},
		{
			"name": "Supplier - Login",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let json = {}; try { json = pm.response.json(); } catch(e) {}; if (json.token) { pm.collectionVariables.set('supplierToken', json.token); if (json.user && json.user.id) pm.collectionVariables.set('SUPPLIER_ID', json.user.id); }"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"supp1@example.com\",\n  \"password\": \"pass123\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/auth/login",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"auth",
						"login"
					]
				}
			},
			"response": []
		},
		{
			"name": "Supplier - Create Product",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let json = {}; try { json = pm.response.json(); } catch(e) {}; if (json.product) { pm.collectionVariables.set('PRODUCT_ID', json.product.id); }"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{supplierToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Rice\",\n  \"description\": \"Sona Masoori\",\n  \"pricePerUnit\": 50.25,\n  \"baseUomId\": \"{{KG_UOM_ID}}\",\n  \"initialStock\": 100\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/products",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"products"
					]
				}
			},
			"response": []
		},
		{
			"name": "Supplier - Update Stock (GM)",
			"request": {
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{supplierToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"quantity\": 500,\n  \"absolute\": false,\n  \"uomId\": \"{{GM_UOM_ID}}\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/products/{{PRODUCT_ID}}/stock",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"products",
						"{{PRODUCT_ID}}",
						"stock"
					]
				}
			},
			"response": []
		},
		{
			"name": "Buyer - Place Order (GM)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let json = {}; try { json = pm.response.json(); } catch(e) {}; if (json.order) { pm.collectionVariables.set('ORDER_ID', json.order.id); }"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{buyerToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"items\": [\n    {\n      \"productId\": \"{{PRODUCT_ID}}\",\n      \"supplierId\": \"{{SUPPLIER_ID}}\",\n      \"quantity\": 750,\n      \"uomId\": \"{{GM_UOM_ID}}\"\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/orders",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"orders"
					]
				}
			},
			"response": []
		},
		{
			"name": "Buyer - List My Orders",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{buyerToken}}"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/api/orders",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"orders"
					]
				}
			},
			"response": []
		},
		{
			"name": "Admin - Login",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let json = {}; try { json = pm.response.json(); } catch(e) {}; if (json.token) { pm.collectionVariables.set('adminToken', json.token); }"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"admin@example.com\",\n  \"password\": \"pass123\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/auth/login",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"auth",
						"login"
					]
				}
			},
			"response": []
		},
		{
			"name": "Admin - Approve Order",
			"request": {
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{adminToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"status\": \"APPROVED\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/orders/{{ORDER_ID}}/status",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"orders",
						"{{ORDER_ID}}",
						"status"
					]
				}
			},
			"response": []
		},
		{
			"name": "Admin - Analytics",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{adminToken}}"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/api/admin/analytics",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"admin",
						"analytics"
					]
				}
			},
			"response": []
		},
		{
			"name": "Supplier - Incoming Orders",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{supplierToken}}"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/api/orders",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"orders"
					]
				}
			},
			"response": []
		},
		{
			"name": "Admin - Orders by Supplier",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{adminToken}}"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/api/orders?supplier_id={{SUPPLIER_ID}}",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"api",
						"orders"
					],
					"query": [
						{
							"key": "supplier_id",
							"value": "{{SUPPLIER_ID}}"
						}
					]
				}
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:3000"
		},
		{
			"key": "buyerToken",
			"value": ""
		},
		{
			"key": "supplierToken",
			"value": ""
		},
		{
			"key": "adminToken",
			"value": ""
		},
		{
			"key": "SUPPLIER_ID",
			"value": ""
		},
		{
			"key": "PRODUCT_ID",
			"value": ""
		},
		{
			"key": "KG_UOM_ID",
			"value": ""
		},
		{
			"key": "GM_UOM_ID",
			"value": ""
		},
		{
			"key": "ORDER_ID",
			"value": ""
		},
		{
			"key": "LT_UOM_ID",
			"value": ""
		},
		{
			"key": "ML_UOM_ID",
			"value": ""
		}
	]
}